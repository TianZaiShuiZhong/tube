# 求解器精度验证报告 (Solver Verification Report)

本文档详细说明了“基于管单元的高温管道蠕变高效求解器”的精度验证方法、测试案例设计及验证结果。为了确保求解器的物理真实性，我们采用**理论解对标 (Theoretical Benchmarking)** 与 **数值机制验证 (Numerical Mechanism Verification)** 相结合的策略。

## 1. 验证策略 (Verification Strategy)

本求解器不依赖“黑盒”对比，而是通过构建具有解析解或明确物理特征的经典力学模型，直接验证核心算法的正确性。

*   **线性弹性阶段**：对比材料力学经典梁理论公式。
*   **几何非线性阶段**：验证弯管特有的刚度耦合效应（Karman 效应）。
*   **材料非线性阶段**：验证本构模型（Norton 蠕变律）的积分准确性。
*   **温度依赖阶段**：检查 MPTEMP/MPDATA 插值后对 $E, \nu, \alpha, \rho$ 的影响，确保热应变与自重使用一致的温度段。

## 2. 自动化验证脚本 (Automated Verification Script)

项目包含一个独立的自动化验证脚本 `scripts/verify_physics.py`，该脚本不依赖任何外部有限元软件，直接在 Python 环境中构建模型、求解并比对理论值。

### 运行方法

```bash
PYTHONPATH=src python3 scripts/verify_physics.py
```

## 3. 测试案例详解 (Test Cases Detail)

### 案例 1：悬臂管弹性弯曲 (Cantilever Elastic Bending)

验证基础的 6-DOF 梁单元刚度矩阵及坐标变换是否正确。

*   **模型描述**：
    *   长度 $L=1000$ mm，外径 $D=100$ mm，壁厚 $t=5$ mm。
    *   一端全约束，另一端施加横向力 $F=1000$ N。
    *   材料弹性模量 $E=200,000$ MPa。
*   **理论解**：
    根据欧拉-伯努利梁理论，端部挠度 $\delta$ 为：
    $$ \delta = \frac{F L^3}{3 E I} $$
    其中惯性矩 $I = \frac{\pi}{64}(D^4 - (D-2t)^4)$。
*   **验证结果**：
    *   理论值：0.987294 mm
    *   求解器值：0.987294 mm
    *   **误差：0.0000%**
    *   **结论**：线性刚度矩阵实现精确无误。

### 案例 2：弯管 Karman 效应 (Elbow Karman Effect)

验证 7-DOF 管单元特有的“弯曲-椭圆化”耦合机制。这是本项目区别于普通梁单元的核心特征。

*   **模型描述**：
    *   90度弯管，曲率半径 $R=500$ mm。
    *   施加面内弯矩 $M$。
*   **物理机制**：
    弯管在承受弯矩时，截面会发生扁平化（Ovalization）。这种变形由刚度矩阵中的耦合项 $K_{couple}$ 驱动，连接了弯曲自由度 $\theta_z$ 和椭圆化自由度 $a$。
*   **验证标准**：
    在纯弯矩作用下，求解器必须计算出非零的椭圆化幅值 ($a \neq 0$)。如果退化为普通梁，则 $a$ 恒为 0。
*   **验证结果**：
    *   椭圆化幅值非零，且随弯矩线性放大，证明耦合项正确激活。

### 案例 3：蠕变本构积分 (Creep Constitutive Integration)

验证时间步进算法和 Norton 蠕变律的实现。

*   **模型描述**：
    *   单轴拉伸杆件，恒定应力 $\sigma$。
    *   材料服从 Norton 律：$\dot{\epsilon}_{cr} = C_1 \sigma^{C_2}$。
*   **验证标准**：
    求解器计算出的应变率应等于理论公式值。
*   **验证结果**：
    *   单元测试比对通过，误差在数值舍入范围内。

### 案例 4：温度插值与热应变 (Thermal Interpolation)

*   **模型描述**：使用 `MPTEMP/MPDATA` 给出多温度点的 $E, \nu, \alpha, \rho$，设置 `REFT`。
*   **验证标准**：在截面上热应变应符合 $\alpha (T-REFT)$；自重载荷应随插值密度更新；升/降温时刚度与热应变方向一致。
*   **结果要点**：插值段切换平滑，无突跳；热应变与自重共用同一温度段，避免偏差。

## 4. 综合算例数值验证 (Comprehensive Numerical Verification)

除了上述单元级验证外，我们还针对赛题提供的完整 CDB 模型进行了系统级验证。该过程不仅验证了求解器对复杂模型的解析能力，还通过物理量级分析排除了潜在的实现错误。

### 4.1 验证工具
开发了专用脚本 `scripts/verify_results_data.py`，直接读取求解器输出的 VTK 文件，提取最大位移场数据，并与基于材料力学和热力学的粗略估算值进行对比。

### 4.2 调试与修正过程
在调试阶段，针对物理不一致性进行了修正：

1. **压力等效**：弯管内压改为基于曲率的 Bourdon 分布载荷（而非节点近似），并保留端面推力。可通过 `--pressure-equiv` 开关对比。
2. **温度插值**：加入 MPTEMP/MPDATA 线性插值，热应变按 REFT 扣除，自重/压力使用插值密度，避免温度段切换带来的刚度突变。
3. **VTK 曲面标量一致性**：曲面四边形点数与标量长度保持一致，解决 ParaView “datasize mismatch” 警告。

### 4.3 最终验证结果

执行 `python3 scripts/verify_results_data.py` 获得的最终数据如下：

#### (1) PIPE288_PLAST (直管塑性/热膨胀)
*   热应变、重力、端面推力叠加后，位移量级与材料力学估算一致。
*   多温度段插值平滑，无刚度突跳。

#### (2) ELBOW290_PLAST (弯管塑性)
*   观测到椭圆化与弯曲耦合的柔化效应，开启/关闭压力等效位移方向一致、量级可对比。

#### (3) PIPE288_CREEP (高温蠕变)
*   时间序列位移单调演化，积分点应力逐步松弛，符合 Norton 律趋势。

## 5. 结论 (Conclusion)

通过上述严格的物理验证，确认本求解器：
1.  **基础扎实**：符合经典弹性与热膨胀理论，压力等效和自重等载荷处理一致。
2.  **特性显著**：弯管 Karman 耦合、Bourdon 压力效应与椭圆化模态均被捕捉。
3.  **计算可信**：无需依赖外部商业软件即可自证；VTK 输出与标量一致，可直接在 ParaView 浏览。
4.  **系统健壮**：能处理热、重力、压力、塑性与蠕变等多物理场组合。
